"use strict";function MailboxComponent(t,e){this.component=t,this.options={mailDeleteUrl:"",mailEmptyFolder:"",mailMoveToSpamUrl:"",ibaRemoveUrl:"",saveUsersettingsUrl:""},$.extend(this.options,e),this.mailPrototype=$('<li><div class="sender"></div><div class="subject"></div><div class="date"></div><div class="options"><span class="reply" title="Antworten"></span><span class="spam" title="Spam"></span><span class="trash" title="LÃ¶schen"></span></div></li>'),this.loadElements(),this.loadEvents()}MailboxComponent.prototype={loadElements:function(){this.unreadBox=this.component.find(".unread-box"),this.unreadTotalCount=this.unreadBox.find(".total .number"),this.unreadSpamCount=this.unreadBox.find(".spam .number"),this.unreadLink=this.unreadBox.find(".inbox-link"),this.loginSecurity=this.component.find(".login-security"),this.nav=this.component.find(".nav"),this.navMail=this.nav.find(".mail"),this.navMailSync=this.nav.find(".mail .sync"),this.navStorage=this.nav.find(".storage"),this.navAdd=this.nav.find(".add"),this.navUnreadCount=this.nav.find(".mail .number"),this.navUnreadLabel=this.nav.find(".mail .label"),this.navTabs=this.component.find(".nav-tabs"),this.inbox=this.component.find(".inbox-container"),this.noMails=this.component.find(".tab-mail .no-mails"),this.storageKnob=this.component.find("#smartdrive-knob"),this.storageKnobValue=this.component.find("#smartdrive-knob-val"),this.storageKnobWrap=this.component.find(".tab-storage .knob-wrap"),this.storageQuotaUsed=this.component.find("#usedsmartdrive"),this.storageQuotaAvailable=this.component.find("#maxsmartdrive"),this.storageUploadBtn=this.component.find(".tab-storage .js-upload"),this.footer=this.component.find(".footer"),this.footerQuotaLink=this.footer.find(".quota a"),this.footerMailKnob=this.footer.find(".quota .knob"),this.mailStorage=this.component.find(".mail-storage"),this.mailStorageKnob=this.mailStorage.find(".knob"),this.mailStorageKnobValue=this.mailStorage.find(".knob-wrap .value"),this.smartdriveStorage=this.component.find(".smartdrive-storage"),this.inboxAdModal=$("[data-remodal-id=iba-us]").remodal()},loadEvents:function(){this.navMailSync.on("click",$.proxy(this.navMailSyncClicked,this)),this.storageKnobWrap.on("click",$.proxy(this.storageKnobClicked,this)),this.storageUploadBtn.on("click",$.proxy(this.storageUploadClicked,this)),this.footerQuotaLink.on("click",$.proxy(this.footerQuotaLinkClicked,this)),this.loginSecurity.on("click",$.proxy(this.loginSecurityClicked,this)),this.inbox.on("scroll",$.proxy(this.observeInboxAdVisibility,this)),this.unreadLink.on("click",$.proxy(this.unreadLinkClicked,this)),this.nav.delegate("li .rm","click",$.proxy(this.navRmClicked,this)),this.nav.delegate("li","click",$.proxy(this.navClicked,this)),this.inbox.delegate("li","click",$.proxy(this.mailClicked,this)),this.inbox.delegate("li .options span","click",$.proxy(this.mailOptionClicked,this)),this.inbox.delegate("li .option .close","click",$.proxy(this.closeInboxAd,this)),this.inbox.delegate("li .option .oba","click",$.proxy(this.obaClicked,this)),this.footer.delegate("a","click",$.proxy(this.footerLinkClicked,this)),this.mailStorage.delegate(".folders .empty","click",$.proxy(this.mailStorageEmptyFolderClicked,this)),this.mailStorage.delegate(".close","click",$.proxy(this.mailStorageCloseClicked,this)),this.mailStorage.delegate("a.extend-mail-storage","click",$.proxy(this.extendMailStorage,this)),this.mailStorage.delegate("a.goto-folder-overview","click",$.proxy(this.gotoFolderOverview,this)),this.smartdriveStorage.delegate(".close","click",$.proxy(this.closeSmartdriveStorage,this)),this.smartdriveStorage.delegate("a.extend","click",$.proxy(this.smartdriveStorageExtendClicked,this)),this.inboxAdModal.$modal.delegate("button","click",$.proxy(this.inboxAdModalButtonClicked,this))},buildBrandLogoUrl:function(t){return"//logo.ui-portal.de/td/"+t+"/logo_77x14.png"},clickedOutsidePopup:function(t){var e=$(t.target);e.parents(".knob-wrap.storage").length||e.parents(".smartdrive-storage").length||this.closeSmartdriveStorage()},closeInboxAd:function(t){t.stopPropagation();var e=$(t.currentTarget).parents("li");if(e.detach(),$("<img/>").attr("src",this.getInboxAdTrackingUrl(e.data("iba").data,"delete")),$("<img/>").attr("src",this.options.ibaRemoveUrl.replace("_POS_",e.data("iba").data.position)),$.nxConfig("get").nxUsersetting.inboxAd.disabledOn){var i=$.nxConfig("get").nxUsersetting.inboxAd.disabledOn,a=(new Date).getTime();if(5184e5>a-i)return;$.nxConfig("get").nxUsersetting.inboxAd.disabledOn=null}$.nxConfig("get").nxUsersetting.inboxAd.dismissCount+=1,$.nxConfig("get").nxUsersetting.inboxAd.dismissCount>=9&&($.nxConfig("get").nxUsersetting.inboxAd.dismissCount=0,this.inboxAdModal.open()),this.saveUsersettings()},closeSmartdriveStorage:function(){this.smartdriveStorage.removeClass("open"),this.boundOuterClick&&($(document).off("click",this.boundOuterClick),this.boundOuterClick=null)},extendMailStorage:function(t){t.preventDefault(),nx.iac.Client.openGotoFeature({goto_feature:"upselling_speicherplatz",mediacode:"03951360"}),this.mailStorage.removeClass("open")},footerQuotaLinkClicked:function(t){t.preventDefault(),this.mailStorage.hasClass("open")?this.mailStorage.removeClass("open"):this.mailStorage.addClass("open")},getBlockNameForNavElement:function(t){return t.hasClass("storage")?"smartdriveblock":void 0},getInboxAdTrackingUrl:function(t,e){var i=t.tracking[e];return i=i.replace(/http[s]?:\/\//g,"//"),t.adBlockAcceptance&&t.urlPrefixes&&t.urlPrefixes[t.adBlockAcceptance]&&(i=i.replace(/(\/\/).*?(\/.*)/g,"$1"+t.urlPrefixes[t.adBlockAcceptance]+"$2")),i},getKnobBackgroundColor:function(){switch(this.getTheme()){case"freemail":return"#dcdcdc";default:return"#dcdcdc"}},getKnobForegroundColor:function(t){if(t=t||0,t>=96)return"#c70000";if(t>=76)return"#ffc600";switch(this.getTheme()){case"freemail":return"#6593d2";case"tropicisland":return"#106e80";case"intenserouge":return"#84194a";case"nightblue":return"#4e769a";case"intensegreen":return"#84aa2a";case"intensepurple":return"#6e2f89"}},getSenderHtml:function(t){var e=$("<span></span>");return t.security&&t.security.trustedSenderInboxMailSealURI&&$("<img/>").addClass("seal").attr("src","//img.ui-portal.de/trusteddialog/trustlogo/trustlogo_14x14.png").appendTo(e),t.security&&t.security.logoId&&t.security.brandLogo===!0?$("<img/>").addClass("brand").attr("src",this.buildBrandLogoUrl(t.security.logoId)).appendTo(e):$("<span></span>").text(t.sender.replace(/"/gi,"").replace(/\s<.*>$/,"")).appendTo(e),e},getSubjectHtml:function(t){var e=$("<span/>");return t.pgp&&$("<span/>").addClass("lock").html("&nbsp;").appendTo(e),$("<span/>").text(t.subject.replace(/</g,"&lt;")).appendTo(e),e},getTheme:function(){var t=$("html");return t.hasClass("theme-bg-intenseblue")?"freemail":t.hasClass("theme-bg-tropicisland")?"tropicisland":t.hasClass("theme-bg-intenserouge")?"intenserouge":t.hasClass("theme-bg-nightblue")?"nightblue":t.hasClass("theme-bg-intensegreen")?"intensegreen":t.hasClass("theme-bg-intensepurple")?"intensepurple":void 0},gotoFolderOverview:function(){nx.iac.Client.createUsecase("settings_mail_folder_overview").send(),this.mailStorage.removeClass("open")},footerLinkClicked:function(t){var e=$(t.currentTarget),i=e.parent(".col");i.hasClass("new-mail")?nx.iac.Client.createUsecase("mail_compose").send():i.hasClass("quota")||i.hasClass("inbox")&&nx.iac.Client.createUsecase("open_mail").send()},inboxAdModalButtonClicked:function(t){var e=$(t.currentTarget),i=this.inboxAdModal.$modal.find("input[name=disable]");this.inboxAdModal.close(),i.prop("checked")&&($.nxConfig("get").nxUsersetting.inboxAd.disabledOn=(new Date).getTime(),this.saveUsersettings()),e.hasClass("primary")&&nx.iac.Client.openGotoFeature({goto_feature:"premium_upselling",data:"3qyYbaW1nYVN0dypZ81cc6okBd5BbxEsxfUaiGadqQzs3_qh7SPlc5hfavdDhL5kS0zeFkyIhZq8974hBPnFYrowU6CiKD4uucdnQO7wmKq1wuI2c7vIty6T4ECiPy-zTrkiFkzKPe5-rHiEYz7yoGPM38vSkAcZ6rW-R-7pTig="})},init:function(){this.state=$.nxConfig("get").nxUsersetting.mailblockstate.data,this.selectTab("mail"),this.renderNavigation(),this.requestTrinityData(),this.requestSmartdriveData(),this.renderLoginSecurity(),this.supportsCanvas()&&(this.storageKnob.knob({displayInput:!1,width:"56",readOnly:!0,bgColor:this.getKnobBackgroundColor(),fgColor:this.getKnobForegroundColor()}),this.mailStorageKnob.knob({displayInput:!1,width:"56",readOnly:!0,bgColor:this.getKnobBackgroundColor(),fgColor:this.getKnobForegroundColor()}),this.footerMailKnob.knob({displayInput:!1,width:"16",readOnly:!0,bgColor:this.getKnobBackgroundColor(),fgColor:this.getKnobForegroundColor()}))},loginSecurityClicked:function(t){nx.iac.Client.createUsecase(this.loginSecurity.data("usecase")).send(),this.loginSecurity.hide(),$.ajax({type:"POST",data:{csecappstarted:"NOW"},timeout:1e3,url:$.nxRouting("cockpit_persist_user_settings")}),t.stopImmediatePropagation()},mailClicked:function(t){var e=$(t.currentTarget);return e.hasClass("more")?void nx.iac.Client.createUsecase("inbox_unread").send():e.hasClass("iba")?($("<img/>").attr("src",this.getInboxAdTrackingUrl(e.data("iba").data,"click")),void nx.iac.Client.createUsecase("open_inboxad",{ad_data:e.data("iba").data}).send()):(nx.iac.Client.createUsecase("mail_read",{mailid:e.data("mail_id")}).send(),void nx.iac.Client.track({section:"click.mailwidget.open_mail"}))},mailDelete:function(t){$.ajax({url:this.options.mailDeleteUrl,timeout:2500,data:{mail_id:t.data("mail_id")},type:"DELETE",cache:!1,success:$.proxy(this.mailDeleteSuccess,this,t),error:function(){$.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:delete_mail_failed")}})},mailDeleteSuccess:function(t){t.remove(),this.requestTrinityData()},mailMoveToSpam:function(t){$.ajax({url:this.options.mailMoveToSpamUrl,timeout:2500,data:{mail_id:t.data("mail_id")},type:"POST",cache:!1,success:$.proxy(this.mailMoveToSpamSuccess,this,t),error:function(){$.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:move_to_spam")}})},mailMoveToSpamSuccess:function(t){t.remove(),this.requestTrinityData()},mailOptionClicked:function(t){t.stopPropagation();var e=$(t.currentTarget),i=e.parents("li"),a=i.data("mail_id");e.hasClass("reply")?(nx.iac.Client.createUsecase("mail_reply",{mailid:a}).send(),nx.iac.Client.track({section:"click.mailwidget.reply_mail"})):e.hasClass("spam")?(this.mailMoveToSpam(i),nx.iac.Client.track({section:"click.mailwidget.move_to_spam"})):e.hasClass("trash")&&(this.mailDelete(i),nx.iac.Client.track({section:"click.mailwidget.delete_mail"}))},mailStorageCloseClicked:function(t){this.mailStorage.removeClass("open")},mailStorageEmptyFolderClicked:function(t){var e=$(t.currentTarget).parents("li"),i=e.data("folder_id");$.ajax({url:this.options.mailEmptyFolder,timeout:800,data:{folderid:i},type:"GET",cache:!1,success:$.proxy(this.mailStorageEmptySuccess,this),error:function(){$.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:empty_folder")}})},mailStorageEmptySuccess:function(){this.requestTrinityData()},navClicked:function(t){var e=$(t.currentTarget).attr("data-tab");"settings"==e?nx.iac.Client.createUsecase("open_mailblock_settings").send():this.selectTab(e)},navMailSyncClicked:function(t){t.stopPropagation(),this.requestTrinityData()},navRmClicked:function(t){t.stopPropagation();var e=$(t.currentTarget),i=e.parents("li"),a=this.getBlockNameForNavElement(i);nx.iac.Client.track({section:"click.dashboard.panel_"+a.replace("block","")+".hide"}),$.nxConfig("get").nxUsersetting.mailblockstate.data[a]=0,this.saveUsersettings(this.renderNavigation)},numberFormat:function(t){return(""+t).replace(/\B(?=(\d{3})+(?!\d))/g,".")},obaClicked:function(t){t.stopPropagation();var e=$(t.currentTarget).parents("li");window.open(e.data("iba").data.optoutUrl,"ObaDescriptionWindow","width=940,height=720")},observeInboxAdVisibility:function(t){var e=this.inbox.outerHeight();$.each(this.inboxAds,$.proxy(function(t,i){if(!0!==i.trackedDisplay){var a=i.element.position().top,s=a+i.element.outerHeight();a>0&&e>s&&(i.trackedDisplay=!0,$("<img/>").attr("src",this.getInboxAdTrackingUrl(i.data,"display")))}},this))},receiveData:function(t){"service_mediacenter_data"==t.ressource()?this.receiveSmartdriveData(t):"service_trinity_fm_mails"==t.ressource()&&this.receiveTrinityData(t)},receiveSmartdriveData:function(t){if(200==t.status()){if(this.smartdriveData=JSON.parse(t.data()),this.smartdriveData.ratio=Math.ceil(this.smartdriveData.quotaUsed/this.smartdriveData.quota*100),this.smartdriveData.ratio=this.smartdriveData.ratio>100?100:this.smartdriveData.ratio,this.smartdriveData.mobileActive=!1,this.smartdriveData.pcSyncActive=!1,this.smartdriveData.quota>5e9){var e=(this.smartdriveData.quota+"").slice(-1);("1"==e||"5"==e)&&(this.smartdriveData.mobileActive=!0),("3"==e||"5"==e)&&(this.smartdriveData.pcSyncActive=!0)}this.component.removeClass("storage-warning storage-alert storage-error"),this.smartdriveData.ratio>99?this.component.addClass("storage-error"):this.smartdriveData.ratio>95?this.component.addClass("storage-alert"):this.smartdriveData.ratio>75&&this.component.addClass("storage-warning"),this.renderSmartdriveData()}else $.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:smartdrive_data_failed")},receiveTrinityData:function(t){this.trinityData=t,this.trinityData.actualSize=Math.floor(this.trinityData.info.usedBytes/1048576),this.trinityData.maxSize=Math.floor(this.trinityData.info.maxBytes/1048576),this.trinityData.sizeRatio=Math.ceil(this.trinityData.actualSize/this.trinityData.maxSize*100),this.trinityData.sizeRatio=this.trinityData.sizeRatio>100?100:this.trinityData.sizeRatio,this.component.removeClass("mail-warning mail-alert mail-error"),this.trinityData.sizeRatio>99?this.component.addClass("mail-error"):this.trinityData.sizeRatio>95?this.component.addClass("mail-alert"):this.trinityData.sizeRatio>75&&this.component.addClass("mail-warning"),this.renderTrinityData()},renderLoginSecurity:function(){var t=$.nxConfig("get");t.nxUsersetting.hasOwnProperty("security")&&t.nxUsersetting.security.data&&(this.loginSecurity.data("usecase",t.nxUsersetting.security.data.usecase).text(t.nxUsersetting.security.data.hint).show(),this.component.find(".failed-logins").hide())},renderMailStorage:function(){var t=this.mailStorage.find(".folders");this.supportsCanvas()&&(this.footerMailKnob.trigger("configure",{fgColor:this.getKnobForegroundColor(this.trinityData.sizeRatio)}).val(this.trinityData.sizeRatio).trigger("change"),this.mailStorageKnob.trigger("configure",{fgColor:this.getKnobForegroundColor(this.trinityData.sizeRatio)}).val(this.trinityData.sizeRatio).trigger("change"),this.mailStorageKnobValue.html(this.trinityData.sizeRatio+'<span class="pc">%</span>')),this.mailStorage.find(".overview .quota .used").text(this.numberFormat(this.trinityData.actualSize)),this.mailStorage.find(".overview .quota .total").text(this.numberFormat(this.trinityData.maxSize)),this.trinityData.info.maxBytes<5242880&&this.mailStorage.find(".overview .extend a").text("Kostenlos erweitern");var e={size:0,unread:0,total:0},i=function(t){return t>1024?Math.round(t/1024)+" MB":t+" KB"};$.each(this.trinityData.folder,$.proxy(function(a,s){var n=t.find('[data-type="'+s.folderType+'"]'),o=Math.round(s.usedBytes/1024),r=s.unreadMessages,l=s.totalMessages;n.length?(n.find(".storage").text(i(o)),n.find(".count").html("<strong>"+r+"</strong> / "+l),n.data("folder_id",s.folderId)):(e.size+=o,e.unread+=r,e.total+=l)},this)),t.find(".misc .storage").text(this.numberFormat(i(e.size))),t.find(".misc .count").html("<strong>"+e.unread+"</strong> / "+e.total)},renderNavigation:function(){var t=$.nxConfig("get").nxUsersetting.mailblockstate.data;1==t.smartdriveblock?this.navStorage.removeClass("hide"):this.navStorage.addClass("hide"),0==t.smartdriveblock?this.navAdd.removeClass("hide"):this.navAdd.addClass("hide")},renderTrinityData:function(){var t;if(this.unreadTotalCount.html(this.numberFormat(this.trinityData.info.unreadMessages)),this.unreadSpamCount.html(this.numberFormat(this.trinityData.folderInfo.spam.unread)),this.navUnreadCount.html(this.numberFormat(this.trinityData.info.unreadMessages)),t=this.trinityData.info.unreadMessages>=100?"Ungelesene":this.trinityData.info.unreadMessages>=100?"ungelesene E-Mail":"ungelesene E-Mails",this.navUnreadLabel.text(t),this.unreadBox.find(".total strong").text(t),this.inbox.empty(),this.inbox.removeClass("hide"),this.noMails.addClass("hide"),$.each(this.trinityData.mails,$.proxy(function(t,e){e.subject=e.subject.replace(/</g,"&lt;");var i=this.mailPrototype.clone();i.data("mail_id",e.mail_id),i.find(".sender").html(this.getSenderHtml(e)),i.find(".subject").html(this.getSubjectHtml(e)),i.find(".date").html(e.date),i.appendTo(this.inbox)},this)),this.inboxAds=[],this.trinityData.inboxAds&&$.each(this.trinityData.inboxAds,$.proxy(function(t,e){var i=this.mailPrototype.clone(),a="iba";if(e.adBlockAcceptance&&(a+="-"+e.adBlockAcceptance),i.addClass(a),i.attr("title",e.preview),i.find(".sender").html(e.sender).prepend($("<img/>").addClass("brand").attr("src",e.icons.low)),i.find(".subject").html(e.subject),i.find(".options").remove(),i.find(".date").addClass("option").removeClass("date").html(e.promotext+'<div class="close"></div>'),e.optouticon){var s=$("<img/>").attr("src",e.optouticon).addClass("oba");i.find(".option").addClass("hoba").find(".close").before(s)}var n=this.inbox.find("> li:nth-child("+e.position+")");n.length?n.before(i):i.appendTo(this.inbox);var o={data:e,element:i,trackedDisplay:!1};i.data("iba",o),this.inboxAds.push(o)},this)),this.observeInboxAdVisibility(),0==this.inbox.children().length&&(this.inbox.addClass("hide"),this.noMails.removeClass("hide")),this.trinityData.info.unreadMessages>50){var e=$('<li class="more"><a href="#"></a></li>');e.find("a").text("Alle ungelesenen E-Mails anzeigen"),e.appendTo(this.inbox)}this.renderMailStorage()},renderSmartdriveData:function(){var t=this.smartdriveData.ratio,e=Math.floor(this.smartdriveData.quotaUsed/1048576),i=Math.floor(this.smartdriveData.quota/1048576);this.storageKnob.trigger("configure",{fgColor:this.getKnobForegroundColor(this.smartdriveData.ratio)}).val(t).trigger("change"),this.storageKnobValue.html(100==t?"voll":t+'<span class="pc">%</span>'),this.storageQuotaUsed.text(Math.round(e/1024*100)/100),this.storageQuotaAvailable.text(Math.floor(i/1024)),this.renderSmartdriveStorage()},renderSmartdriveStorage:function(){var t=Math.floor(this.smartdriveData.quota/1048576),e=this.smartdriveStorage.find(".storages");e.find(".total .storage").text(Math.floor(t/1024)+" GB"),this.smartdriveData.mobileActive?(e.find(".mobile .sign").addClass("check"),e.find(".mobile .storage").text("4 GB")):(e.find(".mobile .sign").removeClass("check"),e.find(".mobile .storage").html('<a href="http://www.gmx.net/produkte/mobile/mediacenter-app/" target="_blank">gratis 4 GB</a>')),this.smartdriveData.pcSyncActive?(e.find(".pcsync .sign").addClass("check"),e.find(".pcsync .storage").text("4 GB")):(e.find(".pcsync .sign").removeClass("check"),e.find(".pcsync .storage").html('<a href="http://www.gmx.net/produkte/apps/mediacenter-pc/" target="_blank">gratis 4 GB</a>'))},requestSmartdriveData:function(){$(window).trigger($.Event("data_on_depends",{ressource:"service_mediacenter_data"}))},requestTrinityData:function(){$.ajax({url:$.nxRouting("service_trinity_fm_mails"),timeout:1e4,type:"GET",cache:!1,success:$.proxy(this.receiveTrinityData,this),complete:$.proxy(this.requestTrinityDataCompleted,this),error:$.proxy(this.requestTrinityDataFailed,this)}),this.navMail.addClass("animate")},requestTrinityDataCompleted:function(){this.navMail.removeClass("animate")},requestTrinityDataFailed:function(){$.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:trinity_data_failed")},saveUsersettings:function(t){$.ajax({url:this.options.saveUsersettingsUrl,timeout:3e3,data:$.nxConfig("get").nxUsersetting,type:"POST",cache:!1,success:t?$.proxy(t,this):null,error:function(){$.get("/monitor/count?bucket="+$.nxConfig("get").nxMonitoring.bucket+"&event=freemailer:widget:mail:usersettings_save_failed"),$.nxConsole("warn","An exception occured due to save user settings")}})},selectTab:function(t){this.navTabs.children().removeClass("active"),this.navTabs.find(".tab-"+t).addClass("active"),this.nav.children().removeClass("active"),this.nav.find("."+t).addClass("active")},smartdriveStorageExtendClicked:function(t){t.preventDefault(),nx.iac.Client.openGotoFeature({goto_feature:"partnershop_hermes",data:"WOv6J9siPImLEcjfjaNbORfPQL0fD_5nvpi3cBXIO6Btk81VwdL-jb6SQubNzUpyro3txSj4c8ZyOejDWRoaL8MeqWn39yMx_d7Cwmd8KSA="}),this.closeSmartdriveStorage()},storageKnobClicked:function(t){this.smartdriveStorage.hasClass("open")?this.smartdriveStorage.removeClass("open"):(this.smartdriveStorage.addClass("open"),$(document).on("click",this.boundOuterClick=$.proxy(this.clickedOutsidePopup,this)))},storageUploadClicked:function(t){t.preventDefault(),nx.iac.Client.createUsecase("open_smartdrive_upload").send(),nx.iac.Client.track({section:"click.open_online_speicher"})},supportsCanvas:function(){var t=!!document.createElement("canvas").getContext;return t||this.component.addClass("no-canvas"),t},unreadLinkClicked:function(){nx.iac.Client.track({section:"click.mailwidget.open_all_unread"})}};